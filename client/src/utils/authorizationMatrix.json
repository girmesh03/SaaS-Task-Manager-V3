{
  "__comment": "Single source of truth for authorization. Allow if ANY rule passes.",
  "Organization": {
    "read": [
      {
        "description": "SuperAdmins from platform organization can read any organization",
        "roles": ["SuperAdmin"],
        "requires": ["isPlatformOrgUser"],
        "scope": "any"
      },
      {
        "description": "All roles can read their own organization",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "scope": "ownOrg"
      }
    ],
    "update": [
      {
        "description": "Platform SuperAdmins can update organizations in other organizations",
        "roles": ["SuperAdmin"],
        "requires": ["isPlatformOrgUser"],
        "scope": "crossOrg"
      },
      {
        "description": "Platform SuperAdmins can update their own platform organization",
        "roles": ["SuperAdmin"],
        "requires": ["isPlatformOrgUser"],
        "scope": "ownOrg"
      },
      {
        "description": "Non-platform SuperAdmins can update their own organization",
        "roles": ["SuperAdmin"],
        "requires": ["!isPlatformOrgUser"],
        "scope": "ownOrg"
      }
    ],
    "delete": [
      {
        "description": "Platform SuperAdmins can delete organizations in other organizations",
        "roles": ["SuperAdmin"],
        "requires": ["isPlatformOrgUser"],
        "scope": "crossOrg"
      }
    ]
  },
  "Department": {
    "create": [
      {
        "description": "SuperAdmins can create departments in their own organization",
        "roles": ["SuperAdmin"],
        "scope": "ownOrg"
      }
    ],
    "read": [
      {
        "description": "Platform SuperAdmins and Admins can read departments across organizations",
        "roles": ["SuperAdmin", "Admin"],
        "requires": ["isPlatformOrgUser"],
        "scope": "crossOrg"
      },
      {
        "description": "SuperAdmins and Admins can read departments in their own organization",
        "roles": ["SuperAdmin", "Admin"],
        "scope": "ownOrg"
      },
      {
        "description": "Managers and Users can only read departments in their own department",
        "roles": ["Manager", "User"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "update": [
      {
        "description": "SuperAdmins can update departments in their own organization",
        "roles": ["SuperAdmin"],
        "scope": "ownOrg"
      },
      {
        "description": "Admins can update departments in their own department",
        "roles": ["Admin"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "delete": [
      {
        "description": "SuperAdmins can delete departments in their own organization",
        "roles": ["SuperAdmin"],
        "scope": "ownOrg"
      }
    ]
  },
  "User": {
    "create": [
      {
        "description": "SuperAdmins can create users in their own organization",
        "roles": ["SuperAdmin"],
        "scope": "ownOrg"
      }
    ],
    "read": [
      {
        "description": "Platform SuperAdmins can read any user across all organizations",
        "roles": ["SuperAdmin"],
        "requires": ["isPlatformOrgUser"],
        "scope": "any"
      },
      {
        "description": "SuperAdmins and Admins can read users in their own organization",
        "roles": ["SuperAdmin", "Admin"],
        "scope": "ownOrg"
      },
      {
        "description": "Managers and Users can only read users in their own department",
        "roles": ["Manager", "User"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "update": [
      {
        "description": "All users can update their own user profile",
        "roles": ["User", "Manager", "Admin", "SuperAdmin"],
        "ownership": ["self"]
      },
      {
        "description": "SuperAdmins and Admins can update any user in their own organization",
        "roles": ["SuperAdmin", "Admin"],
        "scope": "ownOrg"
      }
    ],
    "delete": [
      {
        "description": "SuperAdmins can delete users in their own organization",
        "roles": ["SuperAdmin"],
        "scope": "ownOrg"
      }
    ]
  },
  "Task": {
    "create": [
      {
        "description": "SuperAdmins and Admins can create ProjectTasks in their own department",
        "roles": ["SuperAdmin", "Admin"],
        "resourceType": "ProjectTask",
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "SuperAdmins, Admins, and Managers can create AssignedTasks in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager"],
        "resourceType": "AssignedTask",
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "All roles can create RoutineTasks in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "resourceType": "RoutineTask",
        "scope": "ownOrg.ownDept"
      }
    ],
    "read": [
      {
        "description": "Platform SuperAdmins can read any task across all organizations",
        "roles": ["SuperAdmin"],
        "requires": ["isPlatformOrgUser"],
        "scope": "any"
      },
      {
        "description": "All roles can read tasks in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "Users can read tasks where they are assignees or watchers",
        "roles": ["User"],
        "ownership": ["assignees", "watchers"]
      }
    ],
    "update": [
      {
        "description": "SuperAdmins and Admins can update ProjectTasks they created in their own department",
        "roles": ["SuperAdmin", "Admin"],
        "resourceType": "ProjectTask",
        "ownership": ["createdBy"],
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "All roles can update AssignedTasks they created or are assigned to in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "resourceType": "AssignedTask",
        "ownership": ["createdBy", "assignees"],
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "All roles can update RoutineTasks they created in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "resourceType": "RoutineTask",
        "ownership": ["createdBy"],
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "Users can update tasks they are assigned to in their own department",
        "roles": ["User"],
        "ownership": ["assignees"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "delete": [
      {
        "description": "SuperAdmins can delete tasks in their own department",
        "roles": ["SuperAdmin"],
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "Admins can delete ProjectTasks they created in their own department",
        "roles": ["Admin"],
        "resourceType": "ProjectTask",
        "ownership": ["createdBy"],
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "Admins can delete AssignedTasks they created in their own department",
        "roles": ["Admin"],
        "resourceType": "AssignedTask",
        "ownership": ["createdBy"],
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "Managers and Users can delete AssignedTasks they are assigned to in their own department",
        "roles": ["Manager", "User"],
        "resourceType": "AssignedTask",
        "ownership": ["assignees"],
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "Admins, Managers, and Users can delete RoutineTasks they created in their own department",
        "roles": ["Admin", "Manager", "User"],
        "resourceType": "RoutineTask",
        "ownership": ["createdBy"],
        "scope": "ownOrg.ownDept"
      }
    ]
  },
  "TaskActivity": {
    "create": [
      {
        "description": "All roles can create TaskActivity in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "read": [
      {
        "description": "Platform SuperAdmins can read any TaskActivity across all organizations",
        "roles": ["SuperAdmin"],
        "requires": ["isPlatformOrgUser"],
        "scope": "any"
      },
      {
        "description": "All roles can read TaskActivity in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "update": [
      {
        "description": "SuperAdmins, Admins, and Managers can update TaskActivity they created in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager"],
        "ownership": ["createdBy"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "delete": [
      {
        "description": "SuperAdmins can delete TaskActivity in their own department",
        "roles": ["SuperAdmin"],
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "Admins and Managers can delete TaskActivity they created in their own department",
        "roles": ["Admin", "Manager"],
        "ownership": ["createdBy"],
        "scope": "ownOrg.ownDept"
      }
    ]
  },
  "TaskComment": {
    "create": [
      {
        "description": "All roles can create TaskComment in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "read": [
      {
        "description": "Platform SuperAdmins can read any TaskComment across all organizations",
        "roles": ["SuperAdmin"],
        "requires": ["isPlatformOrgUser"],
        "scope": "any"
      },
      {
        "description": "All roles can read TaskComment in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "update": [
      {
        "description": "All roles can update TaskComment they created in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "ownership": ["createdBy"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "delete": [
      {
        "description": "SuperAdmins can delete TaskComment in their own department",
        "roles": ["SuperAdmin"],
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "Admins, Managers, and Users can delete TaskComment they created in their own department",
        "roles": ["Admin", "Manager", "User"],
        "ownership": ["createdBy"],
        "scope": "ownOrg.ownDept"
      }
    ]
  },
  "Material": {
    "create": [
      {
        "description": "SuperAdmins, Admins, and Managers can create Materials in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "read": [
      {
        "description": "Platform SuperAdmins can read any Material across all organizations",
        "roles": ["SuperAdmin"],
        "requires": ["isPlatformOrgUser"],
        "scope": "any"
      },
      {
        "description": "All roles can read Materials in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "update": [
      {
        "description": "SuperAdmins, Admins, and Managers can update Materials they created in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager"],
        "ownership": ["createdBy"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "delete": [
      {
        "description": "SuperAdmins can delete Materials in their own department",
        "roles": ["SuperAdmin"],
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "Admins and Managers can delete Materials they created in their own department",
        "roles": ["Admin", "Manager"],
        "ownership": ["createdBy"],
        "scope": "ownOrg.ownDept"
      }
    ]
  },
  "Vendor": {
    "create": [
      {
        "description": "Non-platform SuperAdmins and Admins can create Vendors in their own organization",
        "roles": ["SuperAdmin", "Admin"],
        "requires": ["!isPlatformOrgUser"],
        "scope": "ownOrg"
      }
    ],
    "read": [
      {
        "description": "Platform SuperAdmins can read any vendor across all organizations",
        "roles": ["SuperAdmin"],
        "requires": ["isPlatformOrgUser"],
        "scope": "any"
      },
      {
        "description": "All roles can read vendors in their own organization",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "scope": "ownOrg"
      }
    ],
    "update": [
      {
        "description": "SuperAdmins and Admins can update Vendors they created in their own organization",
        "roles": ["SuperAdmin", "Admin"],
        "ownership": ["createdBy"],
        "scope": "ownOrg"
      },
      {
        "description": "Managers can update Vendors they created in their own organization",
        "roles": ["Manager"],
        "ownership": ["createdBy"],
        "scope": "ownOrg"
      }
    ],
    "delete": [
      {
        "description": "SuperAdmins can delete Vendors in their own organization",
        "roles": ["SuperAdmin"],
        "scope": "ownOrg"
      },
      {
        "description": "Admins can delete Vendors they created in their own organization",
        "roles": ["Admin"],
        "ownership": ["createdBy"],
        "scope": "ownOrg"
      }
    ]
  },
  "Attachment": {
    "create": [
      {
        "description": "All roles can create Attachments in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "read": [
      {
        "description": "Platform SuperAdmins can read any Attachment across all organizations",
        "roles": ["SuperAdmin"],
        "requires": ["isPlatformOrgUser"],
        "scope": "any"
      },
      {
        "description": "All roles can read Attachments in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "delete": [
      {
        "description": "SuperAdmins can delete Attachments in their own department",
        "roles": ["SuperAdmin"],
        "scope": "ownOrg.ownDept"
      },
      {
        "description": "Admins, Managers, and Users can delete Attachments they uploaded in their own department",
        "roles": ["Admin", "Manager", "User"],
        "ownership": ["uploadedBy"],
        "scope": "ownOrg.ownDept"
      }
    ]
  },
  "Notification": {
    "read": [
      {
        "description": "All roles can read notifications in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "update": [
      {
        "description": "All roles can update notifications (e.g., mark as read) in their own department",
        "roles": ["SuperAdmin", "Admin", "Manager", "User"],
        "scope": "ownOrg.ownDept"
      }
    ],
    "delete": [
      {
        "description": "SuperAdmins can delete notifications in their own department",
        "roles": ["SuperAdmin"],
        "scope": "ownOrg.ownDept"
      }
    ]
  }
}
